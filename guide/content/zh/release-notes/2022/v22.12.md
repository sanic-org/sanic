---
title: ç¬¬22.12ç‰ˆ (LTS)
---

# ç¬¬22.12ç‰ˆ (LTS)

.. toc::

## ä¸€. å¯¼è¨€

è¿™æ˜¯ç‰ˆæœ¬22 çš„æœ€åç‰ˆæœ¬[å‘è¡Œå‘¨æœŸ](../../org/policies.md#release-schedule)ã€‚ å› æ­¤ï¼Œè¿™æ˜¯ä¸€ä¸ª **é•¿æœŸæ”¯æŒ** å‘å¸ƒï¼Œå¹¶å°†æŒ‰ç…§ [policies]çš„è¯´æ˜æä¾›æ”¯æŒ(../../org/policies.md#long-term support-v-interim-releases)ã€‚

## äº†è§£ä»€ä¹ˆ

æ›´å¤šè¯¦ç»†ä¿¡æ¯åœ¨ [Changelog](https://sanic.readthedocs.io/en/stable/sanic/changelog.html)ã€‚ æ˜¾è‘—çš„æ–°åŠŸèƒ½æˆ–ç ´æŸåŠŸèƒ½ä»¥åŠå‡çº§å†…å®¹...

### ğŸš¨ _BREAKING CHANGE_ - Sanic Inspector ç°åœ¨æ˜¯ä¸€ä¸ª HTTP æœåŠ¡å™¨

Sanic v22.9 å¼•å…¥äº† [Inspector](./v22.9.md#è§†å¯Ÿå‘˜)ï¼Œä»¥ä¾¿å¯¹è¿è¡Œä¸­çš„Sanic å®ä¾‹è¿›è¡Œå®æ—¶æ£€æŸ¥ã€‚ æ­¤åŠŸèƒ½ä¾èµ–äºæ‰“å¼€ TCP å¥—æ¥å­—å’Œé€šè¿‡è‡ªå®šä¹‰åè®®è¿›è¡Œé€šä¿¡ã€‚ è¿™ä¸ªåŸºæœ¬TCPåè®®å·²è¢«ä¸¢å¼ƒï¼Œè½¬è€Œåœ¨å®ƒçš„ä½ç½®ä¸Šè¿è¡Œä¸€ä¸ªå®Œæ•´çš„HTTPæœåŠ¡ã€‚ [äº†è§£æ›´å¤šå…³äºæ£€æŸ¥å‘˜çš„ä¿¡æ¯](../deplement/spector.md)ã€‚

å½“å‰ç‰ˆæœ¬ä»‹ç»äº†ä¸€ä¸ªæ–°çš„ HTTP æœåŠ¡å™¨å’Œåˆ·æ–°çš„ CLI ä½“éªŒã€‚ è¿™å°†ä½¿è¿™é‡Œçªå‡ºæ˜¾ç¤ºçš„å‡ ä¸ªæ–°åŠŸèƒ½ã€‚ ç„¶è€Œï¼Œæœ€é‡è¦çš„å˜åŒ–ä¹Ÿè®¸æ˜¯å°†æ£€æŸ¥å‘˜çš„æ‰€æœ‰å‘½ä»¤è½¬ç§»åˆ°CLIå®ä¾‹çš„å­è§£æå™¨ã€‚

```
$ sanic inspect --help                             

  â–„â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ      â–„â–ˆâ–„      â–ˆâ–ˆ       â–ˆ   â–ˆ   â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
 â–ˆâ–ˆ                 â–ˆ   â–ˆ     â–ˆ â–ˆâ–ˆ     â–ˆ   â–ˆ  â–ˆâ–ˆ
  â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–„    â–€     â–ˆ    â–ˆ   â–ˆâ–ˆ   â–„   â–ˆ  â–ˆâ–ˆ
              â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆ     â–ˆâ–ˆ â–ˆ   â–ˆ  â–„â–„
 â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€  â–ˆ         â–ˆ  â–ˆ       â–ˆâ–ˆ   â–ˆ   â–€â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ

Optional
========
  General:
    -h, --help                      show this help message and exit
    --host HOST, -H HOST            Inspector host address [default 127.0.0.1]
    --port PORT, -p PORT            Inspector port [default 6457]
    --secure, -s                    Whether to access the Inspector via TLS encryption
    --api-key API_KEY, -k API_KEY   Inspector authentication key
    --raw                           Whether to output the raw response information

  Subcommands:
    Run one or none of the below subcommands. Using inspect without a subcommand will fetch general information about the state of the application instance.
    
    Or, you can optionally follow inspect with a subcommand. If you have created a custom Inspector instance, then you can run custom commands. See https://sanic.dev/en/guide/deployment/inspector.html for more details.

    {reload,shutdown,scale,<custom>}
        reload                      Trigger a reload of the server workers
        shutdown                    Shutdown the application and all processes
        scale                       Scale the number of workers
        <custom>                    Run a custom command
```

#### CLI è¿œç¨‹è®¿é—®ç°åœ¨å¯ç”¨

å¦‚ä¸Šæ–‡æ‰€ç¤ºï¼Œæ£€æŸ¥å‘˜çš„`ä¸»æœº`å’Œæ¸¯å£\`ç°åœ¨å·²ç»åœ¨CLIä¸Šæ˜ç¡®æš´éœ²ã€‚ æ­¤å‰åœ¨v22.9ä¸­ï¼Œæ ¹æ®ç”³è¯·å®ä¾‹æ¨å®šã€‚ ç”±äºè¿™ä¸€å˜åŒ–ï¼Œ æ›´å¯èƒ½çš„åšæ³•æ˜¯è®©æ£€æŸ¥ä¸“å‘˜äº†è§£ç°åœºç”Ÿäº§å®ä¾‹å’Œè¿œç¨‹å®‰è£…CLIçš„è®¿é—®ã€‚

ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä»æœ¬åœ°å¼€å‘æœºå™¨æ£€æŸ¥æ‚¨æ­£åœ¨è¿è¡Œçš„ç”Ÿäº§éƒ¨ç½²ã€‚

```
$ sanic inspection --host=1.2.3.4
```

.. è­¦å‘Šï¼š:

```
åœ¨ **production** å®ä¾‹ä¸­ï¼Œè¯·ç¡®ä¿æ‚¨æ­£åœ¨ä½¿ç”¨ _using TLS and authentification_ æè¿°å¦‚ä¸‹ã€‚
```

#### TLS åŠ å¯†ç°åœ¨å¯ç”¨

æ‚¨å¯ä»¥é€šè¿‡æä¾› TLS è¯ä¹¦æ¥åŠ å¯†ç½‘ç»œæµé‡æ¥ä¿æŠ¤æ‚¨çš„è¿œç¨‹æ£€æŸ¥å‘˜è®¿é—®æƒé™ã€‚

```python
app.config.INSPECTOR_TLS_CERT = "/path/to/cert.pem"
app.config.INSPECTOR_TLS_KEY = "/path/to/key.pem"
```

è¦é€šè¿‡ CLI è®¿é—®åŠ å¯†å®‰è£…ï¼Œè¯·ä½¿ç”¨ "--secure" æ ‡è®°ã€‚

```
$ sanic inspection --secure
```

#### èº«ä»½éªŒè¯ç°åœ¨å¯ç”¨

è¦æ§åˆ¶è¿œç¨‹æ£€æŸ¥å™¨çš„è®¿é—®æƒé™ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ API å¯†é’¥ä¿æŠ¤ç»ˆç‚¹ã€‚

```python
app.config.INSPECTOR_API_KEY = "è¶…çº§ç§˜ä¹¦200"
```

è¦é€šè¿‡ CLI è®¿é—®å—ä¿æŠ¤çš„å®‰è£…ï¼Œè¯·ä½¿ç”¨ "--api-key" æ ‡è®°ã€‚

```
$ sanic inspection --api-key=Super-Secret-200
```

This is equivalent to the header: `Authorization: Bearer <KEY>`.

```
$ curl http://localhost:6457-H "Authorization: Morer Super-Secret-200"
```

### ç¼©æ”¾è¿è¡ŒæœåŠ¡å™¨å‘˜æ•°

æ£€æŸ¥ä¸“å‘˜ç°åœ¨èƒ½å¤Ÿç¼©å‡å·¥äººå·¥åºçš„æ•°é‡ã€‚ ä¾‹å¦‚ï¼Œè‹¥è¦ç¼©æ”¾åˆ°ä¸‰ä¸ªä»¿çœŸå“ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```
ç¾å…ƒæ¡‘è‰²ä½“æ£€æŸ¥æ¯”ä¾‹ 3
```

### ä½¿ç”¨è‡ªå®šä¹‰å‘½ä»¤æ‰©å±•æ£€æŸ¥å™¨

æ£€æŸ¥å‘˜ç°åœ¨å¯ä»¥å……åˆ†æ‰©å±•ï¼Œå¯ä»¥å°†è‡ªå®šä¹‰å‘½ä»¤æ·»åŠ åˆ°CLIã€‚ æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹[è‡ªå®šä¹‰å‘½ä»¤](../deplement/æ£€æŸ¥å‘˜.md#custom-commands)ã€‚

```
$ sanic inspection foo --bar
```

### å·¥äººåœ¨å¤±è´¥æ—¶ææ—©é€€å‡º

å¸¦æœ‰v22.9çš„æµç¨‹ç»ç†çš„å¯åŠ¨æ—¶é—´éå¸¸çŸ­ã€‚ è¿™æ˜¯ä¸ºäº†é˜²æ­¢åƒµå±€ã€‚ å¢åŠ åˆ°30ç§’ï¼Œ è€Œä¸”ï¼Œå¦‚æœå·¥äººè¿›ç¨‹å¯åŠ¨æ—¶å‘ç”Ÿå´©æºƒï¼Œæ–°æœºåˆ¶å·²ç»å¢åŠ åˆ°æ—©æœŸå¤±è´¥ã€‚

### å¼•å…¥`JSONResponse` å¹¶æ–¹ä¾¿æ›´æ–°JSONå“åº”æœºæ„

`sanic.response.json`æ–¹ä¾¿æ–¹æ³•ç°åœ¨è¿”å›ä¸€ä¸ªæ–°çš„å­ç±»çš„ `HTTPResponse`ï¼š`JSONResponse`ã€‚ è¿™ç§æ–°ç±»å‹æœ‰ä¸€äº›æ–¹ä¾¿çš„æ–¹æ³•æ¥å¤„ç†ä¸€ä¸ªå“åº”æœºæ„åˆ›å»ºåçš„æ›´æ”¹ã€‚

```python
resp = json({"foot": "bar"})
resp.update({"another": "value"})
```

[return JSON Data](../basics/response.md#returning-json-data) è·å–æ›´å¤šä¿¡æ¯ã€‚

### ä¸‹æ¸¸éœ€æ±‚æ›´æ–°ï¼š`uvloop` å’Œ `websockets`

æœ€å°çš„ `uvloop` è®¾ç½®ä¸º `0.15.0` ã€‚ å·²æ·»åŠ æ›´æ”¹ï¼Œä½¿Sanic å…¼å®¹`websockets`11.0\`ç‰ˆæœ¬ã€‚

### å¼ºåˆ¶é€€å‡º 2nd `ctrl+c`

åœ¨æ”¯æŒæ“ä½œç³»ç»Ÿæ—¶ï¼Œç°æœ‰çš„è¡Œä¸ºæ˜¯ Sanic æœåŠ¡å™¨è¯•å›¾åœ¨ç‚¹å‡» `ctrl+c` æ—¶æ‰§è¡Œå®½æ¾çš„å…³æœºã€‚ è¿™ä¸ªæ–°ç‰ˆæœ¬å°†åœ¨æœ€åˆå…³é—­åç«‹å³å…³é—­ ctrl+cã€‚

### åºŸå¼ƒå’Œç§»é™¤

1. _DEPRECATED_ - åœ¨ v22.9 ä¸­å¼•å…¥çš„ `--checkt*` å‘½ä»¤å·²è¢«ä¸€ä¸ªæ–°çš„å­å‘½ä»¤è§£æå™¨æ›¿æ¢ä¸º `expect` ã€‚ æ——å¸œç‰ˆæœ¬å°†ç»§ç»­è¿è¡Œåˆ° v23.3ã€‚ é¼“åŠ±æ‚¨ä½¿ç”¨æ›¿æ¢ã€‚ è™½ç„¶è¿™ä¸€çŸ­æš‚çš„åºŸå¼ƒæœŸåç¦»äº†æ ‡å‡†çš„ä¸¤å‘¨æœŸï¼Œä½†æˆ‘ä»¬å¸Œæœ›è¿™ç§å˜åŒ–èƒ½å¤Ÿå°½é‡å‡å°‘å¹²æ‰°ã€‚
   ```
   OLD sanic ... --inspect
   new sanic ... Inspection

   OLD sanic . .. --inspect-raw
   New sanic ... inspection --raw

   OLD sanic . .. --inspect-reload
   æ–°çš„sanic... æ£€æŸ¥é‡æ–°åŠ è½½

   OLD sanic... --inspect-shutdown
   æ–°çš„sanic... æ£€æŸ¥å…³æœº
   ```

## æ–°é—»

è¨å°¼å…‹ç¤¾åŒºç»„ç»‡å°†ç”±ä¸€ä¸ªæ–°çš„æŒ‡å¯¼å§”å‘˜ä¼šé¢†å¯¼ï¼Œä»»æœŸä¸º2023å¹´ã€‚ æœ‰ä¸¤åè¿”å›çš„æˆå‘˜å’Œä¸¤åæ–°æˆå‘˜ã€‚

[@ahopkins](https://github.com/ahopkins) _returning_
[@prryplatypus](https://github.com/prryplatypus) _returning_ \
[@sjsadowski](https://github.com/sjsadowski) _NEW_
[@Tronic](https://github.com/Tronic) _NEW_

2023å¹´ç‰ˆæœ¬ç®¡ç†å‘˜æ˜¯ï¼š[@ahopkins](https://github.com/ahopkins)å’Œ[@sjsadowski](https://github.com/sjsadowski)ã€‚

å¦‚æœæ‚¨æœ‰å…´è¶£æ›´å¤šåœ°å‚ä¸Sanicï¼Œè¯·åœ¨[DiscordæœåŠ¡å™¨](https://discord.gg/RARQzAEMAA)è”ç³»æˆ‘ä»¬ã€‚

## è°¢è°¢ä½ 

Thank you to everyone that participated in this release: :clap:

[@aaugustin](https://github.com/aaaugustin)
[@ahopkins](https://github.com/ahopkins)
[@ChihweiLHBird](https://github.com/ChihweiLHBird)
[@kijk2869](https://github.com/kijk2869)
[@LiraNuna](https://github.com/LiraNuna)
[@prplatryypus](https://github.com/prryplatypus)
[@sjsadowski](https://github.com/sjsadowski)
[@todddialpad](https://github.com/todddialpad)
[@

---

å¦‚æœæ‚¨å–œæ¬¢è¿™ä¸ªé¡¹ç›®ï¼Œè¯·è€ƒè™‘ææ¬¾ã€‚ å½“ç„¶ï¼Œæˆ‘ä»¬å–œæ¬¢ä»£ç è´¡çŒ®ï¼Œä½†æˆ‘ä»¬ä¹Ÿå–œæ¬¢ä»»ä½•å½¢å¼çš„è´¡çŒ®ã€‚ è€ƒè™‘æ’°å†™ä¸€äº›æ–‡æ¡£ï¼Œæ˜¾ç¤ºå…³é—­çš„æƒ…å†µï¼ŒåŠ å…¥å¯¹è¯å¹¶è®©æ‚¨çš„å£°éŸ³ä¸ºäººæ‰€çŸ¥ï¼Œå¦‚æœæ‚¨èƒ½å¤Ÿï¼š[é‡‘èè´¡çŒ®](https://opencollective.com/sanic-org/)ã€‚
